/**
 * Developer: Alexandr Voronyansky
 * E-mail: alexandr@voronynsky.com
 * Date: 04.10.13
 * Time: 10:07
 */
(function(e,s){document.fullScreen=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.documentElement.requestFullscreen||document.documentElement.mozRequestFullScreen||document.documentElement.webkitRequestFullscreen;document.cancelFullScreen=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen;var q={slideClass:"",autoplay:!1,autoplayDelay:2E3,progressBar:!0,slideIndex:!0,thumbnails:!1,controls:["next","prev",
    "play","fullscreen"],enableHotKeys:!1,enableScroll:!1,toggleEffect:"base"},h={next:{text:"\u0432\u043f\u0435\u0440\u0435\u0434",hotKeyHelp:" ( \u041f\u0440\u043e\u0431\u0435\u043b, \u2192, \u2191 )",className:"ss-next",title:"\u043b\u0438\u0441\u0442\u0430\u0435\u043c \u0432\u043f\u0435\u0440\u0435\u0434",init:function(a){var b=this;e(this).on("click._ss",".ss-next",function(a){f.next.apply(b);a.preventDefault()})}},prev:{text:"\u043d\u0430\u0437\u0430\u0434",hotKeyHelp:" ( Backspace, \u2190, \u2193 )",
    className:"ss-prev",title:"\u043b\u0438\u0441\u0442\u0430\u0435\u043c \u043d\u0430\u0437\u0430\u0434",init:function(a){var b=this;e(this).on("click._ss",".ss-prev",function(a){f.prev.apply(b);a.preventDefault()})}},play:{text:"\u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438",hotKeyHelp:" (Ctrl + P, Ctrl + Enter)",textActive:"\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c",className:"ss-play",title:"\u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438",
    titleActive:"\u043e\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c",init:function(a){var b=this;e(this).on("click._ss",".ss-play",function(c){a.isPlaying?f.stop.apply(b):f.play.apply(b);c.preventDefault()})}},fullscreen:{text:"\u043d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d",hotKeyHelp:" (Ctrl + F)",textActive:"\u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c",className:"ss-fullscreen",title:"\u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u0440\u0435\u0437\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u0432 \u043f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435",
    titleActive:"\u0432\u044b\u0439\u0442\u0438 \u0438\u0437 \u043f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u0436\u0438\u043c\u0430 (ESC)",init:function(a){var b=this;e(this).on("click._ss",".ss-fullscreen",function(a){f.fullscreen.apply(b);a.preventDefault()})}}},m={base:function(a,b){var c=new e.Deferred;a.removeClass("active");b.addClass("active");c.resolve();return c.promise()},fade:function(a,b){b.css("opacity",0).addClass("active");return e.when(a.animate({opacity:0},
    200,function(){a.removeClass("active").css("opacity",1)}),b.animate({opacity:1},150)).promise()},scrolllr:function(a,b){b.css("left","-"+b.width()+"px").addClass("active");return e.when(a.animate({left:a.width()+"px"},500,function(){a.removeClass("active").css("left",0)}),b.animate({left:0},500)).promise()},scrolltb:function(a,b){b.css("top","-"+b.height()+"px").addClass("active");return e.when(a.animate({top:a.height()+200+"px"},500,function(){a.removeClass("active").css("top",0)}),b.animate({top:0},
    500)).promise()}},l={init:function(a){var b=this,c=e(this),d={};if(!c.data("ss_data")&&(a&&"all"===a.controls&&(a.controls=q.controls),d.settings=e.extend(e.extend({},q),a||{}),d.allSlides=c.children(d.settings.slideClass),d.isPlaying=!1,d.tick=null,0!=d.allSlides.length)){a=d.allSlides.filter(function(){return!e(this).hasClass("ss-disabled")});var g=a.filter(".ss-start");d.enableSlideCount=a.length;d.actualSlide=null;c.addClass("ss-slide-show");"static"===c.css("position")&&c.css({position:"relative"});
    d.allSlides.addClass("ss-slide").css({position:"absolute"});e.each(a,function(a,b){e(b).addClass("ss-inqueue").data("ss_index",a+1)});d.actualSlide=0==g.length?a.first():g.first();d.actualIndex=d.actualSlide.data("ss_index");d.actualSlide.addClass("active");if(d.settings.controls&&"[object Array]"===Object.prototype.toString.call(d.settings.controls)){a=d.settings.controls;var k;for(k=0;k<a.length&&h.hasOwnProperty(a[k]);k++)g=e("."+h[a[k]].className,c),0==g.length&&(g=e('<a class="'+h[a[k]].className+
        '" href="#">'+h[a[k]].text+"</a>"),g.appendTo(c)),g.addClass("ss-control"),g.attr("title",d.settings.enableHotKeys?h[a[k]].title+h[a[k]].hotKeyHelp:h[a[k]].title),h[a[k]].init.apply(this,[d])}d.settings.progressBar&&(d.progressBar=e(".ss-progress",c),0==d.progressBar.length&&(d.progressBar=e('<div class="ss-control ss-progress"></div>'),d.progressBar.css({width:l.getPersentage(d.enableSlideCount,d.actualIndex)+"%"}).appendTo(c)));d.settings.slideIndex&&d.actualIndex&&(d.slideIndex=e(".ss-slide-index",
        c),0==d.slideIndex.length&&(d.slideIndex=e('<div class="ss-control ss-slide-index">'+d.actualIndex+"</div>"),d.slideIndex.appendTo(c)));if(d.settings.enableHotKeys)e(document).on("keydown._ss",function(a){if(a.ctrlKey){if(80==a.keyCode||13==a.keyCode)f.play.apply(b),a.preventDefault();70==a.keyCode&&(f.fullscreen.apply(b),a.preventDefault())}else{if(37==a.keyCode||40==a.keyCode||8==a.keyCode)f.prev.apply(b),a.preventDefault();if(32==a.keyCode||38==a.keyCode||39==a.keyCode)f.next.apply(b),a.preventDefault()}});
    if(d.settings.enableScroll){var m=e.throttle(300,!0,f.prev),r=e.throttle(300,!0,f.next);c.on("mousewheel._ss",function(a,d,c,e){0<e?m.apply(b):r.apply(b);a.preventDefault()})}if(d.settings.thumbnails){var n=e(d.settings.thumbnails);if(n.length){var p=0;e.each(d.allSlides,function(a,b){var c=e(b),g=e('<div class="ss-thumb"></div>');g.appendTo(n);c.hasClass("ss-disabled")?g.addClass("ss-disabled"):(p+=1,g.data("ss_index",p).addClass("ss-inqueue").text(p),p==d.actualIndex&&g.addClass("active"));l.generateThumb.apply(this,
        [c,g])});if(d.allSlides.length)n.on("click._ss",".ss-inqueue",function(a){var c=e(this),d=c.data("ss_index");f.stop.apply(b);l.loadSlide.apply(b,[d]);e(".active",n).removeClass("active");c.addClass("active");a.preventDefault()});c.has(n)&&n.addClass("ss-control")}}e(".ss-control",c).css({"z-index":3E3});c.data("ss_data",d);d.settings.autoplay&&f.play.apply(this)}},loadSlide:function(a){var b=e(this),c=b.data("ss_data"),d=null;if("[object Number]"===Object.prototype.toString.call(a))a--,a!=c.actualIndex-
    1&&0<=a&&a<c.enableSlideCount&&(d=e(".ss-inqueue:eq("+a+")",b));else for(b=c.actualSlide[a](".ss-slide");null==d&&b.length;)b.hasClass("ss-disabled")?b=b[a](".ss-slide"):d=b;d&&d!=c.actualSlide&&(l.toggleSlides(c.actualSlide,d,c.settings,function(a){c.settings.progressBar&&c.progressBar.css({width:l.getPersentage(c.enableSlideCount,a)+"%"});c.settings.slideIndex&&c.slideIndex.text(a)}),c.actualSlide=d,c.actualIndex=c.actualSlide.data("ss_index"),c.settings.thumbnails&&(a=e(c.settings.thumbnails),
    e(".active",a).removeClass("active"),e(".ss-inqueue:eq("+(c.actualIndex-1)+")",a).addClass("active")));return d||c.actualSlide},toggleSlides:function(a,b,c,d){var e=b.attr("data-effect");a=(m.hasOwnProperty(e)?m[e]:m.hasOwnProperty(c.toggleEffect)?m[c.toggleEffect]:m.base)(a,b);d&&a.done(d(b.data("ss_index")))},getPersentage:function(a,b){return 0==a?0:100*(b/a)},generateThumb:function(a,b){var c=a.attr("data-desc");c&&e('<h3 class="ss-thumb-desc">'+c+"</h3>").appendTo(b);"none"===a.css("display")&&
(a.get(0).style.display="block");try{html2canvas(a.get(0),{onrendered:function(c){if(c.toDataURL){var d=e(c);d.appendTo("body");b.css("background-image",'url("'+c.toDataURL()+'")');d.remove();a.get(0).style.display=null}}})}catch(d){}}},f={next:function(){f.stop.apply(this);l.loadSlide.apply(this,["next"])},prev:function(){f.stop.apply(this);l.loadSlide.apply(this,["prev"])},go:function(a){l.loadSlide.apply(this,[a])},play:function(){var a=e(this),b=this,c=a.data("ss_data");if(!c.isPlaying){var d=
    a.find(".ss-play"),g=c.actualSlide;d.addClass("ss-playing").text(h.play.textActive).attr("title",h.play.titleActive);c.isPlaying=!0;c.tick=setInterval(function(){var a=l.loadSlide.apply(b,["next"]);a==g?f.stop.apply(b):g=a},c.settings.autoplayDelay);a.data("ss_data",c)}},stop:function(){var a=e(this),b=a.data("ss_data");b.isPlaying&&(b.isPlaying=!1,clearInterval(b.tick),a.find(".ss-play").removeClass("ss-playing").text(h.play.text).attr("title",h.play.title),a.data("ss_data",b))},fullscreen:function(){var a=
    e(this),b=this;a.hasClass("ss-fs-active")?(document.cancelFullScreen?document.cancelFullScreen():(e("body").removeClass("ss-fs-active"),a.css({position:"relative"})),a.find(".ss-fullscreen").removeClass("ss-expanded").text(h.fullscreen.text).attr("title",h.fullscreen.title),a.removeClass("ss-fs-active"),e(document).off("keyup._ss_esc")):(document.fullScreen?document.fullScreen.call(this[0]):(e("body").addClass("ss-fs-active"),a.css({position:"fixed"})),a.find(".ss-fullscreen").addClass("ss-expanded").text(h.fullscreen.textActive).attr("title",
    h.fullscreen.titleActive),a.addClass("ss-fs-active"),e(document).on("keyup._ss_esc",function(a){27==a.keyCode&&f.fullscreen.apply(b)}))},destroy:function(){var a=e(this),b=a.data("ss_data");b.settings.enableHotKeys&&e(document).off("keydown._ss");b.settings.enableScroll&&a.off("mousewheel._ss");b.settings.thumbnails&&(b=e(b.settings.thumbnails),b.off("click._ss"),e(".ss-thumb",b).remove());e(".ss-slide",a).removeClass("ss-slide ss-inqueue active");e(".ss-control",a).remove();a.off("click._ss");a.removeData("ss_data")}};
    e.fn.presentation=function(a){if(1<this.length)e.each(this,function(b,c){e(c).presentation(a)});else if(f.hasOwnProperty(a))f[a].apply(this,Array.prototype.slice.call(arguments,1));else{if(a&&"[object Object]"!==Object.prototype.toString.call(a))throw Error("Method ["+a+"] not found in presentation api.");l.init.apply(this,arguments)}return this}})(jQuery,window);